<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>GYP - Language Specification</title><link rel="stylesheet" type="text/css" href="../+static/base.HLL9TqKl0YYybSzmT_wTdw.cache.css"/><link rel="stylesheet" type="text/css" href="../+static/doc.MXicahAOcEleYTBJrPykiw.cache.css"/><link rel="stylesheet" type="text/css" href="../+static/prettify/prettify.pZ5FqzM6cPxAflH0va2Ucw.cache.css"/></head><body class="Site"><header class="Site-header Site-header--withNavbar"><div class="Header"><div class="Header-title"><a class="Header-anchor" href="../index.md"><span class="Header-anchorTitle">GYP</span></a></div></div><nav class="Header-nav" role="navigation"><ul><li><a href="../index.md">Home</a></li><li><a href="UserDocumentation.md">User documentation</a></li><li><a href="InputFormatReference.md">Input Format Reference</a></li><li><a href="LanguageSpecification.md">Language specification</a></li><li><a href="Hacking.md">Hacking</a></li><li><a href="Testing.md">Testing</a></li><li><a href="GypVsCMake.md">GYP vs. CMake</a></li></ul></div></header><div class="Site-content Site-Content--markdown"><div class="Container"><div class="doc"><h1><a class="h" name="Language-Specification" href="LanguageSpecification.md#Language-Specification"><span></span></a>Language Specification</h1><div class="toc" role="navigation"><h2>Contents</h2><div class="toc-aux"><ul><li><a href="LanguageSpecification.md#Objective">Objective</a></li><li><a href="LanguageSpecification.md#Background">Background</a></li><li><a href="LanguageSpecification.md#Overview">Overview</a></li><li><a href="LanguageSpecification.md#Detailed-Design">Detailed Design</a></li><ul><li><a href="LanguageSpecification.md#Example">Example</a></li><li><a href="LanguageSpecification.md#Structural-Elements">Structural Elements</a></li><li><a href="LanguageSpecification.md#Top_level-Dictionary">Top-level Dictionary</a></li><li><a href="LanguageSpecification.md#targets">targets</a></li><li><a href="LanguageSpecification.md#configurations">configurations</a></li><li><a href="LanguageSpecification.md#Conditionals">Conditionals</a></li><li><a href="LanguageSpecification.md#Actions">Actions</a></li><li><a href="LanguageSpecification.md#Rules">Rules</a></li><li><a href="LanguageSpecification.md#Copies">Copies</a></li><li><a href="LanguageSpecification.md#Generated-Xcode-pbxproj-Files">Generated Xcode .pbxproj Files</a></li><li><a href="LanguageSpecification.md#Generated-Visual-Studio-vcproj-Files">Generated Visual Studio .vcproj Files</a></li><li><a href="LanguageSpecification.md#Generated-Visual-Studio-sln-Files">Generated Visual Studio .sln Files</a></li></ul><li><a href="LanguageSpecification.md#Caveats">Caveats</a></li></ul></div></div><h2><a class="h" name="Objective" href="LanguageSpecification.md#Objective"><span></span></a>Objective</h2><p>Create a tool for the Chromium project that generates native Visual Studio, Xcode and SCons and/or make build files from a platform-independent input format.  Make the input format as reasonably general as possible without spending extra time trying to &ldquo;get everything right,&rdquo; except where not doing so would likely lead Chromium to an eventual dead end.  When in doubt, do what Chromium needs and don&#39;t worry about generalizing the solution.</p><h2><a class="h" name="Background" href="LanguageSpecification.md#Background"><span></span></a>Background</h2><p>Numerous other projects, both inside and outside Google, have tried to create a simple, universal cross-platform build representation that still allows sufficient per-platform flexibility to accommodate irreconcilable differences.  The fact that no obvious working candidate exists that meets Chromium&lsquo;s requirements indicates this is probably a tougher problem than it appears at first glance.  We aim to succeed by creating a tool that is highly specific to Chromium&rsquo;s specific use case, not to the general case of design a completely platform-independent tool for expressing any possible build.</p><p>The Mac has the most sophisticated model for application development through an IDE.  Consequently, we will use the Xcode model as the starting point (the input file format must handle Chromium&#39;s use of Xcode seamlessly) and adapt the design as necessary for the other platforms.</p><h2><a class="h" name="Overview" href="LanguageSpecification.md#Overview"><span></span></a>Overview</h2><p>The overall design has the following characteristics:</p><ul><li>Input configurations are specified in files with the suffix <code class="code">.gyp</code>.</li><li>Each <code class="code">.gyp</code> file specifies how to build the targets for the &ldquo;component&rdquo; defined by that file.</li><li>Each <code class="code">.gyp</code> file generates one or more output files appropriate to the platform:<ul><li>On Mac, a <code class="code">.gyp</code> file generates one Xcode .xcodeproj bundle with information about how its targets are built.</li><li>On Windows, a <code class="code">.gyp</code> file generates one Visual Studio .sln file, and one Visual Studio .vcproj file per target.</li><li>On Linux, a <code class="code">.gyp</code> file generates one SCons file and/or one Makefile per target</li></ul></li><li>The <code class="code">.gyp</code> file syntax is a Python data structure.</li><li>Use of arbitrary Python in <code class="code">.gyp</code> files is forbidden.<ul><li>Use of eval() with restricted globals and locals on <code class="code">.gyp</code> file contents restricts the input to an evaluated expression, not arbitrary Python statements.</li><li>All input is expected to comply with JSON, with two exceptions: the # character (not inside strings) begins a comment that lasts until the end of the line, and trailing commas are permitted at the end of list and dict contents.</li></ul></li><li>Input data is a dictionary of keywords and values.</li><li>&ldquo;Invalid&rdquo; keywords on any given data structure are not illegal, they&#39;re just ignored.<ul><li>TODO:  providing warnings on use of illegal keywords would help users catch typos.  Figure out something nice to do with this.</li></ul></li></ul><h2><a class="h" name="Detailed-Design" href="LanguageSpecification.md#Detailed-Design"><span></span></a>Detailed Design</h2><p>Some up-front design principles/thoughts/TODOs:</p><ul><li>Re-use keywords consistently.</li><li>Keywords that allow configuration of a platform-specific concept get prefixed appropriately:<ul><li>Examples:  <code class="code">msvs_disabled_warnings</code>, <code class="code">xcode_framework_dirs</code></li></ul></li><li>The input syntax is declarative and data-driven.<ul><li>This gets enforced by using Python <code class="code">eval()</code> (which only evaluates an expression) instead of <code class="code">exec</code> (which executes arbitrary python)</li></ul></li><li>Semantic meanings of specific keyword values get deferred until all are read and the configuration is being evaluated to spit out the appropriate file(s)</li><li>Source file lists:<ul><li>Are flat lists.  Any imposed ordering within the <code class="code">.gyp</code> file (e.g. alphabetically) is purely by convention and for developer convenience.  When source files are linked or archived together, it is expected that this will occur in the order that files are listed in the <code class="code">.gyp</code> file.</li><li>Source file lists contain no mechanism for by-hand folder configuration (<code class="code">Filter</code> tags in Visual Studio, <code class="code">Groups</code> in Xcode)</li><li>A folder hierarchy is created automatically that mirrors the file system</li></ul></li></ul><h3><a class="h" name="Example" href="LanguageSpecification.md#Example"><span></span></a>Example</h3><pre class="code">{
  &#39;target_defaults&#39;: {
    &#39;defines&#39;: [
      &#39;U_STATIC_IMPLEMENTATION&#39;,
      [&#39;LOGFILE&#39;, &#39;foo.log&#39;,],
    ],
    &#39;include_dirs&#39;: [
      &#39;..&#39;,
    ],
  },
  &#39;targets&#39;: [
    {
      &#39;target_name&#39;: &#39;foo&#39;,
      &#39;type&#39;: &#39;static_library&#39;,
      &#39;sources&#39;: [
        &#39;foo/src/foo.cc&#39;,
        &#39;foo/src/foo_main.cc&#39;,
      ],
      &#39;include_dirs&#39;: [
         &#39;foo&#39;,
         &#39;foo/include&#39;,
      ],
      &#39;conditions&#39;: [
         [ &#39;OS==mac&#39;, { &#39;sources&#39;: [ &#39;platform_test_mac.mm&#39; ] } ]
      ],
      &#39;direct_dependent_settings&#39;: {
        &#39;defines&#39;: [
          &#39;UNIT_TEST&#39;,
        ],
        &#39;include_dirs&#39;: [
          &#39;foo&#39;,
          &#39;foo/include&#39;,
        ],
      },
    },
  ],
}
</pre><h3><a class="h" name="Structural-Elements" href="LanguageSpecification.md#Structural-Elements"><span></span></a>Structural Elements</h3><h3><a class="h" name="Top_level-Dictionary" href="LanguageSpecification.md#Top_level-Dictionary"><span></span></a>Top-level Dictionary</h3><p>This is the single dictionary in the <code class="code">.gyp</code> file that defines the targets and how they&#39;re to be built.</p><p>The following keywords are meaningful within the top-level dictionary definition:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">conditions</code></td><td align="left">A conditional section that may contain other items that can be present in a top-level dictionary, on a conditional basis.  See the &ldquo;Conditionals&rdquo; section below.</td></tr><tr><td align="left"><code class="code">includes</code></td><td align="left">A list of <code class="code">.gypi</code> files to be included in the top-level dictionary.</td></tr><tr><td align="left"><code class="code">target_defaults</code></td><td align="left">A dictionary of default settings to be inherited by all targets in the top-level dictionary.  See the &ldquo;Settings keywords&rdquo; section below.</td></tr><tr><td align="left"><code class="code">targets</code></td><td align="left">A list of target specifications.  See the &ldquo;targets&rdquo; below.</td></tr><tr><td align="left"><code class="code">variables</code></td><td align="left">A dictionary containing variable definitions.  Each key in this dictionary is the name of a variable, and each value must be a string value that the variable is to be set to.</td></tr></tbody></table><h3><a class="h" name="targets" href="LanguageSpecification.md#targets"><span></span></a>targets</h3><p>A list of dictionaries defining targets to be built by the files generated from this <code class="code">.gyp</code> file.</p><p>Targets may contain <code class="code">includes</code>, <code class="code">conditions</code>, and <code class="code">variables</code> sections as permitted in the root dictionary. The following additional keywords have structural meaning for target definitions:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">actions</code></td><td align="left">A list of special custom actions to perform on a specific input file, or files, to produce output files.  See the &ldquo;Actions&rdquo; section below.</td></tr><tr><td align="left"><code class="code">all_dependent_settings</code></td><td align="left">A dictionary of settings to be applied to all dependents of the target, transitively.  This includes direct dependents and the entire set of their dependents, and so on.  This section may contain anything found within a <code class="code">target</code> dictionary, except <code class="code">configurations</code>, <code class="code">target_name</code>, and <code class="code">type</code> sections.  Compare <code class="code">direct_dependent_settings</code> and <code class="code">link_settings</code>.</td></tr><tr><td align="left"><code class="code">configurations</code></td><td align="left">A list of dictionaries defining build configurations for the target.  See the &ldquo;Configurations&rdquo; section below.</td></tr><tr><td align="left"><code class="code">copies</code></td><td align="left">A list of copy actions to perform. See the &ldquo;Copies&rdquo; section below.</td></tr><tr><td align="left"><code class="code">defines</code></td><td align="left">A list of preprocesor definitions to be passed on the command line to the C/C++ compiler (via <code class="code">-D</code> or <code class="code">/D</code> options).</td></tr><tr><td align="left"><code class="code">dependencies</code></td><td align="left">A list of targets on which this target depends.  Targets in other <code class="code">.gyp</code> files are specified as <code class="code">../path/to/other.gyp:target_we_want</code>.</td></tr><tr><td align="left"><code class="code">direct_dependent_settings</code></td><td align="left">A dictionary of settings to be applied to other targets that depend on this target.  These settings will only be applied to direct dependents.  This section may contain anything found within a <code class="code">target</code> dictionary, except <code class="code">configurations</code>, <code class="code">target_name</code>, and <code class="code">type</code> sections.  Compare with <code class="code">all_dependent_settings</code> and <code class="code">link_settings</code>.</td></tr><tr><td align="left"><code class="code">include_dirs</code></td><td align="left">A list of include directories to be passed on the command line to the C/C++ compiler (via <code class="code">-I</code> or <code class="code">/I</code> options).</td></tr><tr><td align="left"><code class="code">libraries</code></td><td align="left">A list of list of libraries (and/or frameworks) on which this target depends.</td></tr><tr><td align="left"><code class="code">link_settings</code></td><td align="left">A dictionary of settings to be applied to targets in which this target&#39;s contents are linked.  <code class="code">executable</code> and <code class="code">shared_library</code> targets are linkable, so if they depend on a non-linkable target such as a <code class="code">static_library</code>, they will adopt its <code class="code">link_settings</code>.  This section can contain anything found within a <code class="code">target</code> dictionary, except <code class="code">configurations</code>, <code class="code">target_name</code>, and <code class="code">type</code> sections.  Compare <code class="code">all_dependent_settings</code> and <code class="code">direct_dependent_settings</code>.</td></tr><tr><td align="left"><code class="code">rules</code></td><td align="left">A special custom action to perform on a list of input files, to produce output files.  See the &ldquo;Rules&rdquo; section below.</td></tr><tr><td align="left"><code class="code">sources</code></td><td align="left">A list of source files that are used to build this target or which should otherwise show up in the IDE for this target.  In practice, we expect this list to be a union of all files necessary to build the target on all platforms, as well as other related files that aren&#39;t actually used for building, like README files.</td></tr><tr><td align="left"><code class="code">target_conditions</code></td><td align="left">Like <code class="code">conditions</code>, but evaluation is delayed until the settings have been merged into an actual target.  <code class="code">target_conditions</code> may be used to place conditionals into a <code class="code">target_defaults</code> section but have them still depend on specific target settings.</td></tr><tr><td align="left"><code class="code">target_name</code></td><td align="left">The name of a target being defined.</td></tr><tr><td align="left"><code class="code">type</code></td><td align="left">The type of target being defined. This field currently supports <code class="code">executable</code>, <code class="code">static_library</code>, <code class="code">shared_library</code>, and <code class="code">none</code>.  The <code class="code">none</code> target type is useful when producing output which is not linked. For example, converting raw translation files into resources or documentation into platform specific help files.</td></tr><tr><td align="left"><code class="code">msvs_props</code></td><td align="left">A list of Visual Studio property sheets (<code class="code">.vsprops</code> files) to be used to build the target.</td></tr><tr><td align="left"><code class="code">xcode_config_file</code></td><td align="left">An Xcode configuration (<code class="code">.xcconfig</code> file) to be used to build the target.</td></tr><tr><td align="left"><code class="code">xcode_framework_dirs</code></td><td align="left">A list of framework directories be used to build the target.</td></tr></tbody></table><p>You can affect the way that lists/dictionaries are merged together (for example the way a list in target_defaults interacts with the same named list in the target itself) with a couple of special characters, which are covered in <a href="https://gyp.gsrc.io/docs/InputFormatReference#Merge_Basics_%28=,_?,_+%29.md">Merge Basics</a> and <a href="https://gyp.gsrc.io/docs/InputFormatReference#List_Filters.md">List Filters</a> on the InputFormatReference page.</p><h3><a class="h" name="configurations" href="LanguageSpecification.md#configurations"><span></span></a>configurations</h3><p><code class="code">configurations</code> sections may be found within <code class="code">targets</code> or <code class="code">target_defaults</code> sections.  The <code class="code">configurations</code> section is a list of dictionaries specifying different build configurations.  Because configurations are implemented as lists, it is not currently possible to override aspects of configurations that are imported into a target from a <code class="code">target_defaults</code> section.</p><p>NOTE: It is extremely important that each target within a project define the same set of configurations.  This continues to apply even when a project spans across multiple <code class="code">.gyp</code> files.</p><p>A configuration dictionary may contain anything that can be found within a target dictionary, except for <code class="code">actions</code>, <code class="code">all_dependent_settings</code>, <code class="code">configurations</code>, <code class="code">dependencies</code>, <code class="code">direct_dependent_settings</code>, <code class="code">libraries</code>, <code class="code">link_settings</code>, <code class="code">sources</code>, <code class="code">target_name</code>, and <code class="code">type</code>.</p><p>Configuration dictionaries may also contain these elements:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">configuration_name</code></td><td align="left">Required attribute.  The name of the configuration.</td></tr></tbody></table><h3><a class="h" name="Conditionals" href="LanguageSpecification.md#Conditionals"><span></span></a>Conditionals</h3><p>Conditionals may appear within any dictionary in a <code class="code">.gyp</code> file.  There are two tpes of conditionals, which differ only in the timing of their processing.  <code class="code">conditons</code> sections are processed shortly after loading <code class="code">.gyp</code> files, and <code class="code">target_conditons</code> sections are processed after all dependencies have been computed.</p><p>A conditional section is introduced with a <code class="code">conditions</code> or <code class="code">target_conditions</code> dictionary keyword, and is composed of a list.  Each list contains two or three elements.  The first two elements, which are always required, are the conditional expression to evaluate and a dictionary containing settings to merge into the dictionary containing the <code class="code">conditions</code> or <code class="code">target_conditions</code> section if the expression evaluates to true.  The third, optional, list element is a dictionary to merge if the expression evaluates to false.</p><p>The <code class="code">eval()</code> of the expression string takes place in the context of global and/or local dictionaries that constructed from the <code class="code">.gyp</code> input data, and overrides the <code class="code">__builtin__</code> dictionary, to prevent the execution of arbitrary Python code.</p><h3><a class="h" name="Actions" href="LanguageSpecification.md#Actions"><span></span></a>Actions</h3><p>An <code class="code">actions</code> section provides a list of custom build actions to perform on inputs, producing outputs.  The <code class="code">actions</code> section is organized as a list.  Each item in the list is a dictionary having the following form:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Type</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">action_name</code></td><td align="left">string</td><td align="left">The name of the action.  Depending on how actions are implemented in the various generators, some may desire or require this property to be set to a unique name; others may ignore this property entirely.</td></tr><tr><td align="left"><code class="code">inputs</code></td><td align="left">list</td><td align="left">A list of pathnames treated as inputs to the custom action.</td></tr><tr><td align="left"><code class="code">outputs</code></td><td align="left">list</td><td align="left">A list of pathnames that the custom action produces.</td></tr><tr><td align="left"><code class="code">action</code></td><td align="left">list</td><td align="left">A command line invocation used to produce <code class="code">outputs</code> from <code class="code">inputs</code>.  For maximum cross-platform compatibility, invocations that require a Python interpreter should be specified with a first element <code class="code">&quot;python&quot;</code>.  This will enable generators for environments with specialized Python installations to be able to perform the action in an appropriate Python environment.</td></tr><tr><td align="left"><code class="code">message</code></td><td align="left">string</td><td align="left">A message to be displayed to the user by the build system when the action is run.</td></tr></tbody></table><p>Build environments will compare <code class="code">inputs</code> and <code class="code">outputs</code>.  If any <code class="code">output</code> is missing or is outdated relative to any <code class="code">input</code>, the custom action will be invoked.  If all <code class="code">outputs</code> are present and newer than all <code class="code">inputs</code>, the <code class="code">outputs</code> are considered up-to-date and the action need not be invoked.</p><p>Actions are implemented in Xcode as shell script build phases performed prior to the compilation phase.  In the Visual Studio generator, actions appear files with a <code class="code">FileConfiguration</code> containing a custom <code class="code">VCCustomBuildTool</code> specifying the remainder of the inputs, the outputs, and the action.</p><p>Combined with variable expansions, actions can be quite powerful.  Here is an example action that leverages variable expansions to minimize duplication of pathnames:</p><pre class="code">      &#39;sources&#39;: [
        # libraries.cc is generated by the js2c action below.
        &#39;&lt;(INTERMEDIATE_DIR)/libraries.cc&#39;,
      ],
      &#39;actions&#39;: [
        {
          &#39;variables&#39;: {
            &#39;core_library_files&#39;: [
              &#39;src/runtime.js&#39;,
              &#39;src/v8natives.js&#39;,
              &#39;src/macros.py&#39;,
            ],
          },
          &#39;action_name&#39;: &#39;js2c&#39;,
          &#39;inputs&#39;: [
            &#39;tools/js2c.py&#39;,
            &#39;&lt;@(core_library_files)&#39;,
          ],
          &#39;outputs&#39;: [
            &#39;&lt;(INTERMEDIATE_DIR)/libraries.cc&#39;,
            &#39;&lt;(INTERMEDIATE_DIR)/libraries-empty.cc&#39;,
          ],
          &#39;action&#39;: [&#39;python&#39;, &#39;tools/js2c.py&#39;, &#39;&lt;@(_outputs)&#39;, &#39;CORE&#39;, &#39;&lt;@(core_library_files)&#39;],
        },
      ],
</pre><h3><a class="h" name="Rules" href="LanguageSpecification.md#Rules"><span></span></a>Rules</h3><p>A <code class="code">rules</code> section provides custom build action to perform on inputs, producing outputs.  The <code class="code">rules</code> section is organized as a list.  Each item in the list is a dictionary having the following form:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Type</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">rule_name</code></td><td align="left">string</td><td align="left">The name of the rule.  Depending on how Rules are implemented in the various generators, some may desire or require this property to be set to a unique name; others may ignore this property entirely.</td></tr><tr><td align="left"><code class="code">extension</code></td><td align="left">string</td><td align="left">All source files of the current target with the given extension will be treated successively as inputs to the rule.</td></tr><tr><td align="left"><code class="code">inputs</code></td><td align="left">list</td><td align="left">Additional dependencies of the rule.</td></tr><tr><td align="left"><code class="code">outputs</code></td><td align="left">list</td><td align="left">A list of pathnames that the rule produces. Has access to <code class="code">RULE_INPUT_</code> variables (see below).</td></tr><tr><td align="left"><code class="code">action</code></td><td align="left">list</td><td align="left">A command line invocation used to produce <code class="code">outputs</code> from <code class="code">inputs</code>.  For maximum cross-platform compatibility, invocations that require a Python interpreter should be specified with a first element <code class="code">&quot;python&quot;</code>.  This will enable generators for environments with specialized Python installations to be able to perform the action in an appropriate Python environment. Has access to <code class="code">RULE_INPUT_</code> variables (see below).</td></tr><tr><td align="left"><code class="code">message</code></td><td align="left">string</td><td align="left">A message to be displayed to the user by the build system when the action is run. Has access to <code class="code">RULE_INPUT_</code> variables (see below).</td></tr></tbody></table><p>There are several variables available to <code class="code">outputs</code>, <code class="code">action</code>, and <code class="code">message</code>.</p><table><thead><tr><th align="left"><em>Variable</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">RULE_INPUT_PATH</code></td><td align="left">The full path to the current input.</td></tr><tr><td align="left"><code class="code">RULE_INPUT_DIRNAME</code></td><td align="left">The directory of the current input.</td></tr><tr><td align="left"><code class="code">RULE_INPUT_NAME</code></td><td align="left">The file name of the current input.</td></tr><tr><td align="left"><code class="code">RULE_INPUT_ROOT</code></td><td align="left">The file name of the current input without extension.</td></tr><tr><td align="left"><code class="code">RULE_INPUT_EXT</code></td><td align="left">The file name extension of the current input.</td></tr></tbody></table><p>Rules can be thought of as Action generators. For each source selected by <code class="code">extension</code> an special action is created. This action starts out with the same <code class="code">inputs</code>, <code class="code">outputs</code>, <code class="code">action</code>, and <code class="code">message</code> as the rule. The source is added to the action&#39;s <code class="code">inputs</code>. The <code class="code">outputs</code>, <code class="code">action</code>, and <code class="code">message</code> are then handled the same but with the additional variables. If the <code class="code">_output</code> variable is used in the <code class="code">action</code> or <code class="code">message</code> the <code class="code">RULE_INPUT_</code> variables in <code class="code">output</code> will be expanded for the current source.</p><h3><a class="h" name="Copies" href="LanguageSpecification.md#Copies"><span></span></a>Copies</h3><p>A <code class="code">copies</code> section provides a simple means of copying files.  The <code class="code">copies</code> section is organized as a list.  Each item in the list is a dictionary having the following form:</p><table><thead><tr><th align="left"><em>Keyword</em></th><th align="left"><em>Type</em></th><th align="left"><em>Description</em></th></tr></thead><tbody><tr><td align="left"><code class="code">destination</code></td><td align="left">string</td><td align="left">The directory into which the <code class="code">files</code> will be copied.</td></tr><tr><td align="left"><code class="code">files</code></td><td align="left">list</td><td align="left">A list of files to be copied.</td></tr></tbody></table><p>The copies will be created in <code class="code">destination</code> and have the same file name as the file they are copied from. Even if the <code class="code">files</code> are from multiple directories they will all be copied into the <code class="code">destination</code> directory. Each <code class="code">destination</code> file has an implicit build dependency on the file it is copied from.</p><h3><a class="h" name="Generated-Xcode-pbxproj-Files" href="LanguageSpecification.md#Generated-Xcode-pbxproj-Files"><span></span></a>Generated Xcode .pbxproj Files</h3><p>We derive the following things in a <code class="code">project.pbxproj</code> plist file within an <code class="code">.xcodeproj</code> bundle from the above input file formats as follows:</p><ul><li><code class="code">Group hierarchy</code>: This is generated in a fixed format with contents derived from the input files. There is no provision for the user to specify additional groups or create a custom hierarchy.<ul><li><code class="code">Configuration group</code>: This will be used with the <code class="code">xcode_config_file</code> property above, if needed.</li><li><code class="code">Source group</code>: The union of the <code class="code">sources</code> lists of all <code class="code">targets</code> after applying appropriate <code class="code">conditions</code>.  The resulting list is sorted and put into a group hierarchy that matches the layout of the directory tree on disk, with a root of // (the top of the hierarchy).</li><li><code class="code">Frameworks group</code>: Taken directly from <code class="code">libraries</code> value for the target, after applying appropriate conditions.</li><li><code class="code">Projects group</code>: References to other <code class="code">.xcodeproj</code> bundles that are needed by the <code class="code">.xcodeproj</code> in which the group is contained.</li><li><code class="code">Products group</code>: Output from the various targets.</li></ul></li><li><code class="code">Project References</code>:</li><li><code class="code">Project Configurations</code>:<ul><li>Per-<code class="code">.xcodeproj</code> file settings are not supported, all settings are applied at the target level.</li></ul></li><li><code class="code">Targets</code>:<ul><li><code class="code">Phases</code>: Copy sources, link with libraries/frameworks, ...</li><li><code class="code">Target Configurations</code>: Specified by input.</li><li><code class="code">Dependencies</code>: (local and remote)</li></ul></li></ul><h3><a class="h" name="Generated-Visual-Studio-vcproj-Files" href="LanguageSpecification.md#Generated-Visual-Studio-vcproj-Files"><span></span></a>Generated Visual Studio .vcproj Files</h3><p>We derive the following sections in a <code class="code">.vcproj</code> file from the above input file formats as follows:</p><ul><li><code class="code">VisualStudioProject</code>:<ul><li><code class="code">Platforms</code>:</li><li><code class="code">ToolFiles</code>:</li><li><code class="code">Configurations</code>:<ul><li><code class="code">Configuration</code>:</li></ul></li><li><code class="code">References</code>:</li><li><code class="code">Files</code>:<ul><li><code class="code">Filter</code>:</li><li><code class="code">File</code>:<ul><li><code class="code">FileConfiguration</code>:<ul><li><code class="code">Tool</code>:</li></ul></li></ul></li></ul></li><li><code class="code">Globals</code>:</li></ul></li></ul><h3><a class="h" name="Generated-Visual-Studio-sln-Files" href="LanguageSpecification.md#Generated-Visual-Studio-sln-Files"><span></span></a>Generated Visual Studio .sln Files</h3><p>We derive the following sections in a <code class="code">.sln</code> file from the above input file formats as follows:</p><ul><li><code class="code">Projects</code>:<ul><li><code class="code">WebsiteProperties</code>:</li><li><code class="code">ProjectDependencies</code>:</li></ul></li><li><code class="code">Global</code>:<ul><li><code class="code">SolutionConfigurationPlatforms</code>:</li><li><code class="code">ProjectConfigurationPlatforms</code>:</li><li><code class="code">SolutionProperties</code>:</li><li><code class="code">NestedProjects</code>:</li></ul></li></ul><h2><a class="h" name="Caveats" href="LanguageSpecification.md#Caveats"><span></span></a>Caveats</h2><p>Notes/Question from very first prototype draft of the language. Make sure these issues are addressed somewhere before deleting.</p><ul><li>Libraries are easy, application abstraction is harder<ul><li>Applications involves resource compilation</li><li>Applications involve many inputs</li><li>Applications include transitive closure of dependencies</li></ul></li><li>Specific use cases like cc_library<ul><li>Mac compiles more than just .c/.cpp files (specifically, .m and .mm files)</li><li>Compiler options vary by:<ul><li>File type</li><li>Target type</li><li>Individual file</li></ul></li><li>Files may have custom settings per file per platform, but we probably don&#39;t care or need to support this in gyp.</li></ul></li><li>Will all linked non-Chromium projects always use the same versions of every subsystem?</li><li>Variants are difficult.  We&#39;ve identified the following variants (some specific to Chromium, some typical of other projects in the same ballpark):<ul><li>Target platform</li><li>V8 vs. JSC</li><li>Debug vs. Release</li><li>Toolchain (VS version, gcc, version)</li><li>Host platform</li><li>L10N</li><li>Vendor</li><li>Purify / Valgrind</li></ul></li><li>Will everyone upgrade VS at once?</li><li>What does a dylib dependency mean?</li></ul></div></div></div><footer class="Site-footer"><div class="Footer"><div class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a></div><div class="Footer-links"></ul></div></footer></body></html>